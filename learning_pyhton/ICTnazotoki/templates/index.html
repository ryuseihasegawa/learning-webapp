{% extends "base.html" %}
{% block content %}

<div>
  <h2 class="m-5 text-center">CIOからの挑戦状</h2>

  <div class="container mt-4">
    <div class="row justify-content-center">
      <div class="col-md-6">

        <!-- メインフォーム -->
        {{ render_form(form, button_map={'submit':'primary'}) }}

        <!-- ヒント（フォーム直下に固定） -->
        <div class="d-flex justify-content-right mt-3">
          <form method="GET" action="{{ url_for('hint') }}">
            <button type="submit" class="btn btn-dark">
              ヒント
            </button>
          </form>
        </div>

        <!-- 最終問題ボタン or 注意表示 -->
        {% if all_solved %}
        <div class="text-center mt-4">
          <a href="{{ url_for('final') }}" class="btn btn-danger btn-lg">
            最終問題へ進む
          </a>
        </div>
        {% else %}
        <div class="alert alert-warning text-center mt-4">
          全ての問題に正解すると「最終問題」ボタンが表示されます。
        </div>
        {% endif %}

        <!-- ▼ 正解済み一覧 -->
        <hr class="mt-5 mb-4">

        <div class="mt-5">
          <h4 class="mb-3 text-center">正解した問題と答え</h4>

          {% if solved_list and solved_list|length > 0 %}
          <table class="table table-striped table-bordered align-middle">
            <thead>
              <tr>
                <th style="width: 120px;">問題番号</th>
                <th>答え</th>
              </tr>
            </thead>
            <tbody>
              {% for item in solved_list %}
              <tr>
                <td>{{ item.q }}</td>
                <td>{{ item.answer }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
          {% else %}
          <div class="alert alert-info text-center">
            まだ正解した問題がありません。
          </div>
          {% endif %}
        </div>
        <!-- ▲ 正解済み一覧 -->

        <!-- ログアウト（ページ最下部に固定） -->
        <div class="d-flex justify-content-center mt-5">
          <form method="POST" action="{{ url_for('logout') }}">
            <button type="submit" class="btn btn-outline-secondary">
              ログアウト
            </button>
          </form>
        </div>

      </div>
    </div>
  </div>
</div>

{% endblock %}